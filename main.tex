% This is the main LaTeX file for the document.
% It sets up the document class, loads necessary packages, defines custom commands, and includes the content from other files.

% The document class is 'scrbook' from Koma-Script, which is a versatile class for creating books.
\documentclass[ 
	12pt, % Sets the font size to 12pt.
	a4paper, % Sets the paper size to A4.
	listof=totoc, % Adds the list of figures and tables to the table of contents.
	bibliography=totoc, % Adds the bibliography to the table of contents.
	numbers=noenddot, % Removes the dot after section numbers.
	english, % Sets the main language to English.
	headseplie, % Adds a line under the header.
	%footsepline, % Adds a line above the footer (commented out).
	oneside % Sets the document to single-sided format.
	]{scrbook}

% Font and encoding packages
\usepackage[T1]{fontenc} % Specifies the font encoding.
\usepackage{mathptmx} % Sets the main font to Times New Roman.
\usepackage[utf8]{inputenc} % Sets the input encoding to UTF-8.
\usepackage{babel} % Provides language-specific typographic rules.

% Utility packages
\usepackage{float} % Improves the interface for defining floating objects such as figures and tables.
\usepackage{url} % Provides support for URL typesetting.
\usepackage{xurl} % Provides more robust URL typesetting.
\usepackage{graphicx} % Allows the inclusion of images.
\usepackage{caption} % Provides customization options for captions in floating environments.
\captionsetup{justification=raggedright, singlelinecheck=false} % Configures caption alignment.
\usepackage[a4paper, margin=1in]{geometry} % Sets the page margins.
\usepackage[right]{eurosym} % Provides the Euro symbol.
\usepackage{amssymb} % Provides various mathematical symbols.
\usepackage{csquotes} % Provides context-sensitive quotation facilities.

% Bibliography setup using biblatex
\usepackage[backend=biber, style=bath, sorting=ynt]{biblatex} % Configures biblatex for bibliography management.
\addbibresource{citations.bib} % Specifies the bibliography file.
\DefineBibliographyStrings{english}{%
  urlseen = {Accessed}, % Customizes the 'urlseen' string.
}
\assignrefcontextentries[]{*}

% Custom cite commands for biblatex
\DeclareCiteCommand{\citeauthor}
    {}
    {\bibhyperref{\printnames{labelname}}}
    {\multicitedelim}
    {}

\DeclareCiteCommand{\citeyear}
    {}
    {\bibhyperref{\printfield{year}}}
    {\multicitedelim}
    {\usebibmacro{postnote}}

\DeclareCiteCommand{\citeyearpar}
    {}
    {\mkbibparens{\bibhyperref{\printfield{year}, \usebibmacro{postnote}}}}
    {\multicitedelim}
    {}

\DeclareCiteCommand{\citeyearparnopage}
    {}
    {\mkbibparens{\bibhyperref{\printfield{year}}}}
    {\multicitedelim}
    {}

\DeclareCiteCommand{\citeauthoryearpar}
    {}
    {\bibhyperref{\printnames{labelname}\space\mkbibparens{\printfield{year}, \usebibmacro{postnote}}}}
    {\multicitedelim}
    {}

\DeclareCiteCommand{\citeauthoryearparnopage}
    {}
    {\bibhyperref{\printnames{labelname}\space\mkbibparens{\printfield{year}}}}
    {\multicitedelim}
    {}

% Table of contents indentation settings
\RedeclareSectionCommand[tocindent=0pt]{chapter}
\RedeclareSectionCommand[tocindent=0pt]{section}
\RedeclareSectionCommand[tocindent=0pt]{subsection}
\RedeclareSectionCommand[tocindent=0pt]{subsubsection}
\RedeclareSectionCommand[tocindent=0pt]{paragraph}
\RedeclareSectionCommand[tocindent=0pt]{subparagraph}

% Spacing and layout packages
\usepackage{setspace} % Provides commands for setting line spacing.
\usepackage{enumitem} % Provides customization for list environments.
\usepackage{fancyhdr} % Provides extensive control over headers and footers.
\pagestyle{fancy} % Sets the page style to 'fancy'.
\fancyhf{} % Clears all header and footer fields.
\fancyhead[C]{\thepage} % Puts the page number in the center of the header.
\renewcommand{\headrulewidth}{0pt} % Removes the horizontal line in the header.
\RedeclareSectionCommand[style=section]{chapter} 

% Redefine the 'plain' page style for chapter beginnings
\fancypagestyle{plain}{%
  \fancyhf{}%
  \fancyhead[C]{\thepage}%
  \renewcommand{\headrulewidth}{0pt}%
}

\usepackage{blindtext} % Provides dummy text for testing.

% Hyperlinking setup
\usepackage[ 
   colorlinks,        % Colors links instead of using boxes.
   linkcolor=black,   % Sets the color of internal links.
   filecolor=black,   % Sets the color of file links.
   citecolor=black,   % Sets the color of citation links.
   urlcolor=black	  % Sets the color of URL links.
   ]{hyperref} % Enables cross-referencing within the document.
\urlstyle{rm} % Sets the URL style to roman font.
\usepackage[figure]{hypcap} % Corrects hyperlink anchors for figures.

% Glossary setup
\usepackage[acronym, nonumberlist, ]{glossaries} % Enables glossary and acronym management.
\setglossarystyle{long} % Sets the glossary style to 'long'.
\renewenvironment{theglossary}%
 {\begin{longtable}[l]{lp{\glsdescwidth}}}%
 {\end{longtable}}

% Code listing setup
\usepackage{listings,xcolor} % Provides support for including code snippets.
\usepackage[normalem]{ulem} % Provides underlining capabilities.
\usepackage{amsmath} % Provides advanced mathematical typesetting.
\useunder{\uline}{\ul}{}

% Table and figure packages
\usepackage{array} % Provides extended capabilities for arrays and tables.
\usepackage{geometry} % Manages page dimensions.
\geometry{a4paper, margin=1in} % Sets A4 paper with 1-inch margins.
\usepackage{booktabs} % Provides high-quality table formatting.
\usepackage{chngcntr} % Allows for changing counter associations.
\counterwithout{figure}{chapter} % Makes figure numbering independent of chapters.
\counterwithout{table}{chapter} % Makes table numbering independent of chapters.

% Custom colors for code listings
\definecolor{dkgreen}{rgb}{0,.6,0}
\definecolor{dkblue}{rgb}{0,0,.6}
\definecolor{dkyellow}{cmyk}{0,0,.8,.3}

% Configuration for code listings
\lstset{
    numbers=left, 
    numberstyle=\tiny, 
    numbersep=5pt,
    breaklines=true,
    frame=single,
    escapeinside={(*@}{@*)},
    language=sh,
    basicstyle=\ttfamily\fontsize{10}{12}\selectfont,
    keywordstyle    = \color{dkblue},
    stringstyle     = \color{red},
    identifierstyle = \color{dkgreen},
    commentstyle    = \color{gray},
    emph            =[1]{php},
    emphstyle       =[1]\color{black},
    emph            =[2]{if,and,or,else},
    emphstyle       =[2]\color{dkyellow}
    } 

% Font size for chapter titles
\setkomafont{chapter}{\LARGE}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%% Custom Formatting
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Page margin settings
\geometry{verbose,tmargin=3cm,bmargin=2cm,lmargin=2.1cm,rmargin=3cm} 

% Prevents widow and club lines
\clubpenalty = 10000 \widowpenalty = 10000 \displaywidowpenalty = 10000 

% Custom command for referencing figures in footnotes
\newcommand{\footfigref}[1]{\footnote{Abb. \ref{#1} auf Seite \pageref{#1}}}

% Footer skip length
\setlength{\footskip}{10mm}

% Spacing adjustments for section titles
\RedeclareSectionCommand[%
    beforeskip=0.5\baselineskip,
    afterskip=0.5\baselineskip
]{chapter}

\RedeclareSectionCommand[%
    beforeskip=0.5\baselineskip,
    afterskip=0.5\baselineskip
]{section}

\RedeclareSectionCommand[%
    beforeskip=0.1\baselineskip,
    afterskip=0.1\baselineskip
]{subsection}

\RedeclareSectionCommand[%
    beforeskip=0.01\baselineskip,
    ]{paragraph}

% Caption spacing adjustments
\setlength{\abovecaptionskip}{4pt}
\setlength{\belowcaptionskip}{0pt}
\setlength{\intextsep}{1pc}

% Caption font size
\addtokomafont{caption}{\small}

% Removes the dot at the end of glossary entries
\renewcommand*{\glspostdescription}{}

% Koma-Script option for paragraph spacing
\KOMAoptions{parskip=full*}

% Font style for disposition elements
\addtokomafont{disposition}{\rmfamily} 

% Initializes glossaries
\makenoidxglossaries

% Loads glossary entries from an external file
\loadglsentries{glossar.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%% Custom Commands for Document Information
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\studentlastname}{-}
\newcommand{\studentfirstname}{-}
\newcommand{\type}{-}
\newcommand{\topic}{-}
\newcommand{\subtopic}{-}
\newcommand{\course}{-}
\newcommand{\company}{-}
\newcommand{\supervisorhwr}{-}
\newcommand{\intake}{-}
\newcommand{\semester}{-}
\newcommand{\dateofsubmission}{-}
\newcommand{\placeofsubmission}{-}
\newcommand{\titleSperrvermerk}{STATEMENT OF CONFIDENTIALITY}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% PDF Metadata
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\hypersetup{%
  pdftitle={\topic},
  pdfsubject={\subtopic},
  pdfauthor={\studentfirstname~\studentlastname},
  pdfkeywords={\type, \topic, \subtopic, \course, \company, \supervisorhwr, \intake, \semester},
}

\begin{document}

% Includes custom hyphenation patterns
\include{./hyphenation.tex}

% Includes the statement of confidentiality
\input{00_statement_of_confidentiality.tex}

% Includes the front page
\newpage
\input{./01_frontpage.tex}

% Sets line spacing to one and a half
\onehalfspacing

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%% Main Document Content
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Sets page numbering to Roman numerals for front matter
\pagenumbering{Roman}

% Includes the table of contents
\newpage
\tableofcontents{}

% Includes the glossary and acronyms
\addcontentsline{toc}{chapter}{Akronyms}
\textnormal{\printnoidxglossaries}

% Includes the list of figures
\newpage
\listoffigures

% Includes the list of tables
\newpage
\listoftables

\clearpage

% Sets page numbering to Arabic numerals for the main body
\pagenumbering{arabic}

% Includes the main text
\input{./02_maintext.tex}

%%%%%%%%%%%%%%%%%%%%%%%%%%
% Bibliography
%%%%%%%%%%%%%%%%%%%%%%%%%
\newpage
\newrefcontext[sorting=nyt]
\chapter{Reference List}
\vspace*{-2\baselineskip}
\textnormal{\printbibliography[heading=none]}

% Includes the appendix
\newpage
\input{./04_appendix.tex}

% Includes the statement of academic integrity
\newpage
\input{./05_statementofacademicintegrity.tex}

\end{document}
